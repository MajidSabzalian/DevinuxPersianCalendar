let __dev=a=>$(a);class PublicApi{constructor(){this.Api=PublicApi.Api}static Api={toPersianNumber:a=>a&&a.toString().replace(/\d/g,a=>"\u06F0\u06F1\u06F2\u06F3\u06F4\u06F5\u06F6\u06F7\u06F8\u06F9"[a]),toEnglishNumber:a=>a&&a.toString().replace(/[۰-۹٠-٩]/g,a=>"\u06F0\u06F1\u06F2\u06F3\u06F4\u06F5\u06F6\u06F7\u06F8\u06F9\u0660\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669".indexOf(a)%10)}}class DevinuxPersianCalendarDay extends PublicApi{constructor(a=2e3,b=1,c=1,d=0,e=0,f=0,g="en"){switch(super(),this.year=a,this.month=b,this.day=c,this.hour=d,this.minute=e,this.second=f,this.calendar=g,this.monthName="",this.dayName="",this.dayIndex=this.getDate().getDay(),this.currentDay=this.getDate().toLocaleDateString()==new Date().toLocaleDateString(),g){default:case"en":{this.monthName=["January","February","March","April","May","June","July","August","September","October","November","December"][this.month-1],this.dayName=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][this.dayIndex]}break;case"fa":{this.monthName=["\u0641\u0631\u0648\u0631\u062F\u06CC\u0646","\u0627\u0631\u062F\u06CC\u0628\u0647\u0634\u062A","\u062E\u0631\u062F\u0627\u062F","\u062A\u06CC\u0631","\u0645\u0631\u062F\u0627\u062F","\u0634\u0647\u0631\u06CC\u0648\u0631","\u0645\u0647\u0631","\u0622\u0628\u0627\u0646","\u0622\u0630\u0631","\u062F\u06CC","\u0628\u0647\u0645\u0646","\u0627\u0633\u0641\u0646\u062F"][this.month-1],this.dayName=["\u0634\u0646\u0628\u0647","\u06CC\u06A9\u0634\u0646\u0628\u0647","\u062F\u0648\u0634\u0646\u0628\u0647","\u0633\u0647\u200C\u0634\u0646\u0628\u0647","\u0686\u0647\u0627\u0631\u0634\u0646\u0628\u0647","\u067E\u0646\u062C\u0634\u0646\u0628\u0647","\u062C\u0645\u0639\u0647"][this.dayIndex]}}}getDate(){if("en"==this.calendar)return new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second);return"fa"==this.calendar?DevinuxPersianCalendar.jalaliToGregorian(this.year,this.month,this.day,this.hour,this.minute,this.second).getDate():void console.error("unknown calendar type",this)}static fromDate(a=new Date){return DevinuxPersianCalendar.gregorianToJalali(a.getFullYear(),a.getMonth()+1,a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds())}}class DevinuxPersianCalendar extends PublicApi{static option={position:"abs",autoPosition:!0,calendar:"persian",valueSetter:a=>`${a.year}/${a.month}/${a.day} ${a.hour}:${a.minute}:${a.second}`,formatter:a=>PublicApi.Api.toPersianNumber(a),onSelect:()=>{},onSet:()=>{},onOpen:()=>{},onClose:()=>{},closeAfterSelect:!1,min:new Date(2e3,0,1),max:new Date(2100,0,1),selectionMode:"range",yearUp:`<label class="btn"><i class="fal fa-chevrons-left"></i></label>`,yearDown:`<label class="btn"><i class="fal fa-chevrons-right"></i></label>`,monthUp:`<label class="btn"><i class="fal fa-chevron-left"></i></label>`,monthDown:`<label class="btn"><i class="fal fa-chevron-right"></i></label>`,today:`<label class="btn"><i class="fal fa-check"></i><span>امروز</span></label>`,showButton:`<label class="btn end"><i class="fad fa-calendar"></i></label>`,width:`300px`,dateEditor:!0,timeEditor:!0,showOnFocus:!0,showOnButton:!0};constructor(){super(),this.root=void 0,this.e=void 0,this.year=1,this.month=1,this.day=1,this.selectedDay=void 0,this.selectedMonth=void 0,this.selectedYear=void 0,this.hour=1,this.minute=1,this.second=1}setOption(a={}){return this.option={...this.option,...a},this}init(a){let b=this.#getOption();return this.e=__dev(a),this.e.wrap(`<div class="devinux persian-calendar"></div>`),this.root=__dev(this.e).closest(`.persian-calendar`),this.root.off().mousedown(()=>{this.#open()}),!0==b.showOnButton&&this.root.append(b&&b.showButton||`<label class="end"><i class="fal fa-calendar"></i></label>`),this.e.addClass(`hide`).attr({type:"text"}),this.e.off().focusin(()=>{this.#checkFirstValue(),this.#open()}),this.e.change(()=>{this.#checkFirstValue(),this.#print()}),__dev(document).mouseup(a=>{let b=__dev(a.target).closest(`.persian-calendar`);0!=b.length||__dev(a.target).is(`.persian-calendar`)||this.#close()}),this}#checkFirstValue(){let a=__dev(this.e).val().toString(),b=DevinuxPersianCalendarDay.fromDate();0>=a.trim().length&&(a=`${b.year}/${b.month}/${b.day} ${b.hour}:${b.minute}:${b.second}`);let c=a.split(/\D+/).filter(Boolean);3<=c.length&&(this.year=+c[0],this.month=+c[1],this.day=+c[2],this.hour=+(c[3]||0),this.minute=+(c[4]||0),this.second=+(c[5]||0),!this.selected&&(this.selected=new DevinuxPersianCalendarDay(this.year,this.month,this.day,this.hour,this.minute,this.second,"fa")),this.selected.year=+c[0],this.selected.month=+c[1],this.selected.day=+c[2],this.selected.hour=+(c[3]||0),this.selected.minute=+(c[4]||0),this.selected.second=+(c[5]||0))}#print(){let a=this.#getOption(),b=100,d=DevinuxPersianCalendar.getShamsiMonthDays(DevinuxPersianCalendar.jalaliToGregorian(this.year,this.month,1).getDate()),e=d[0];0<e.dayIndex&&6>e.dayIndex&&(d=[...Array(e.dayIndex+1).fill(void 0).map(a=>a),...d]),0==__dev(this.root).find(".calendar").length&&__dev(this.root).append(`<div class="calendar flex fix rows" style="width: ${a&&a.width||"300px"}"></div>`);let f=__dev(this.root).find(".calendar");f.html(``),f.append(`
            ${a&&!0==a.dateEditor?`
                <div class="start control flex cols">
                    <div class="end year-down">${a.yearDown||""}</div>
                    <div class="end month-down">${a.monthDown||""}</div>
                    <div class="center date">
                        <select class="cmb-month">${Array(12).fill(0).map((a,b)=>new DevinuxPersianCalendarDay(1e3,b+1,1,1,1,1,"fa")).map(a=>`<option ${this.month==a.month?"selected":""} value="${a.month}">${a.monthName}</option>`).join(``)}</select>
                        <select class="cmb-year">${Array(b).fill(0).map((a,c)=>this.year-b/2+c).map(a=>`<option ${a==this.year?"selected":""} value="${a}">${a}</option>`).join(``)}</select>
                    </div>
                    <div class="start month-up">${a.monthUp||""}</div>
                    <div class="start year-up">${a.yearUp||""}</div>
                </div>
                <div class="center month">
                </div>`:``}
            ${a&&!0==a.timeEditor?`
                <div class="end flex cols times">
                    <div class="center hour">
                        <strong>ساعت</strong>
                        <input type="number" class="h" value="${this.hour}" min="0" max="23" step="1" />
                    </div>
                    <div class="center minute">
                        <strong>دقیقه</strong>
                        <input type="number" class="m" value="${this.minute}" min="0" max="59" step="1" />
                    </div>
                    <div class="center second">
                        <strong>ثانیه</strong>
                        <input type="number" class="s" value="${this.second}" min="0" max="59" step="1" />
                    </div>
                </div>`:``}
            ${a&&!0==a.dateEditor?`
                <div class="menu flex cols">
                    <div class="btn-today start">${a.today||""}</div>
                </div>
            `:``}
        `);let g=__dev(this.root).find(".calendar > .center"),c="\u0634\u06CC\u062F\u0633\u0686\u067E\u062C".split(``);c.forEach(a=>{g.append(`<label class="header">${a}</label>`)}),d.forEach((b,c)=>{let d=__dev(`<label data-day-index="${b&&b.dayIndex||""}" data-week="${Math.floor(c/7)+1}" class="day"></label>`);b==null?(d.addClass(""),g.append(d)):(!0==b.currentDay&&d.addClass("today"),b.day==(this.selected&&this.selected.day||this.day||0)&&b.month==(this.selected&&this.selected.month||this.month||0)&&b.year==(this.selected&&this.selected.year||this.year||0)&&d.addClass("selected"),d.html(a&&a.formatter(b.day)||b.day),g.append(d),d.off().mouseup(()=>{g.find(".day").removeClass("selected"),d.addClass("selected"),this.selected=b,this.#select()}))}),__dev(this.root).find(".cmb-month").off().change(a=>{this.#changeMonth(__dev(a.currentTarget).val())}),__dev(this.root).find(".cmb-year").off().change(a=>{this.#changeYear(__dev(a.currentTarget).val())}),__dev(this.root).find(".year-up").off().mousedown(()=>{this.#nextYear()}),__dev(this.root).find(".year-down").off().mousedown(()=>{this.#prevYear()}),__dev(this.root).find(".month-up").off().mousedown(()=>{this.#nextMonth()}),__dev(this.root).find(".month-down").off().mousedown(()=>{this.#prevMonth()}),__dev(this.root).find(".btn-today").off().mousedown(()=>{this.#today()}),__dev(this.root).find(".times .h").off().change(a=>{a.currentTarget.validity.valid&&this.#changeHour(a.currentTarget.value)}),__dev(this.root).find(".times .m").off().change(a=>{a.currentTarget.validity.valid&&this.#changeMinute(a.currentTarget.value)}),__dev(this.root).find(".times .s").off().change(a=>{a.currentTarget.validity.valid&&this.#changeSecond(a.currentTarget.value)})}#today(){let a=DevinuxPersianCalendarDay.fromDate();__dev(this.root).find(`.times .h`).val(a.hour).change(),__dev(this.root).find(`.times .m`).val(a.minute).change(),__dev(this.root).find(`.times .s`).val(a.second).change(),__dev(this.root).find(`.cmb-year`).val(a.year),__dev(this.root).find(`.cmb-month`).val(a.month),this.selected=a,this.year=a.year,this.month=a.month,this.day=a.day,this.#print(),this.#select()}#open(){__dev(this.root).is(".show")||(__dev(this.root).addClass(`show`),this.#checkFirstValue(),this.#print());let a=__dev(this.root).get(0).getBoundingClientRect();const b=__dev(window).height()/2,c=__dev(window).width()/2,d=a.x<c?a.x:a.x+a.width,e=a.y>b?a.y:a.y+a.height,f=`translateX(${a.x>c?`-100%`:"0%"})`,g=`translateY(${a.y>b?`-100%`:"0%"})`;__dev(this.root).find(`.calendar`).css({left:`${d}px`,top:`${e}px`,transform:`${f} ${g}`})}#getOption(){return{...DevinuxPersianCalendar.option,...this.option}}#select(){let a=this.#getOption(),b=this.selected||DevinuxPersianCalendarDay.fromDate();b.hour=this.hour,b.minute=this.minute,b.second=this.second;let c=a&&a.valueSetter&&a.valueSetter(b)||`${b.year}/${b.month}/${b.day} ${b.hour}:${b.minute}:${b.second}`;__dev(this.e).val(c),this.selectedDay=b.day,this.selectedMonth=b.month,this.selectedYear=b.year,a&&a.onSelect&&a.onSelect(b,c),a&&!0==a.closeAfterSelect&&this.#close()}#close(){__dev(this.root).removeClass(`show`)}#changeMonth(a){this.month=+a,this.#print(),this.#open()}#changeYear(a){this.year=+a,this.#print(),this.#open()}#changeDay(a){this.day=+a,this.#print(),this.#open()}#changeHour(a){this.hour=+a,this.#select()}#changeMinute(a){this.minute=+a,this.#select()}#changeSecond(a){this.second=+a,this.#select()}#nextMonth(){this.year=12==this.month?this.year+1:this.year,this.month=12==this.month?1:this.month+1,this.#print()}#prevMonth(){this.year=1==this.month?this.year-1:this.year,this.month=1==this.month?12:this.month-1,this.#print()}#prevYear(){this.year--,this.#print()}#nextYear(){this.year++,this.#print()}static gregorianToJalali(a,b,c,d=0,e=0,f=0){var g=Math.floor,h=1600>=a?0:979;a-=1600>=a?621:1600;var i=2<b?a+1:a,j=365*a+g((i+3)/4)-g((i+99)/100)+g((i+399)/400)-80+c+[0,31,59,90,120,151,181,212,243,273,304,334][b-1];h+=33*g(j/12053),j%=12053,h+=4*g(j/1461),j%=1461,365<j&&(h+=g((j-1)/365),j=(j-1)%365);var k=186>j?1+g(j/31):7+g((j-186)/30),l=1+(186>j?j%31:(j-186)%30);return new DevinuxPersianCalendarDay(h,k,l,d,e,f,"fa")}static jalaliToGregorian(a,b,c,d=0,e=0,f=0){var h,i,j,k,g=Math.floor;a+=1595,k=-355668+365*a+8*g(a/33)+g((a%33+3)/4)+c,k+=7>b?31*(b-1):30*(b-7)+186,h=400*g(k/146097),k%=146097,36524<k&&(h+=100*g(--k/36524),k%=36524,365<=k&&k++),h+=4*g(k/1461),k%=1461,365<k&&(h+=g((k-1)/365),k=(k-1)%365),j=k+1;var l=[0,31,0==h%4&&0!=h%100||0==h%400?29:28,31,30,31,30,31,31,30,31,30,31];for(i=0;13>i;i++){var m=l[i];if(j<=m)break;j-=m}return new DevinuxPersianCalendarDay(h,i,j,d,e,f,"en")}static isJalaliLeapYear(a){return[1,5,9,13,17,22,26,30].includes(a%33)}static getShamsiMonthDays(a){let b,c=DevinuxPersianCalendar.gregorianToJalali(a.getFullYear(),a.getMonth()+1,a.getDate());b=6>=c.month?31:11>=c.month?30:DevinuxPersianCalendar.isJalaliLeapYear(c.year)?30:29;const e=[];for(let f=1;f<=b;f++)e.push(new DevinuxPersianCalendarDay(c.year,c.month,f,a.getHours(),a.getMinutes(),a.getSeconds(),"fa"));return e}}DevinuxPersianCalendar.option={};